<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3D Гра без бібліотек</title>
<style>
  body { margin: 0; overflow: hidden; background: #a0a0a0; }
  #game {
    position: relative;
    width: 100vw;
    height: 100vh;
    perspective: 800px;
  }
  #cube {
    position: absolute;
    width: 50px;
    height: 50px;
    background: green;
    transform-style: preserve-3d;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) rotateX(0deg) rotateY(0deg);
  }
  #joystick {
    position: absolute;
    bottom: 50px;
    left: 50px;
    width: 120px;
    height: 120px;
    background: rgba(0,0,0,0.3);
    border-radius: 50%;
    touch-action: none;
  }
  #stick {
    width: 60px;
    height: 60px;
    background: rgba(0,255,0,0.6);
    border-radius: 50%;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }
</style>
</head>
<body>

<div id="game">
  <div id="cube"></div>
  <div id="joystick">
    <div id="stick"></div>
  </div>
</div>

<script>
  const cube = document.getElementById('cube');
  const stick = document.getElementById('stick');
  const joystick = document.getElementById('joystick');

  let posX = window.innerWidth/2, posY = window.innerHeight/2;
  let velX = 0, velY = 0;
  const speed = 5;

  // Джойстик
  let stickX = 0, stickY = 0, dragging = false;

  joystick.addEventListener('touchstart', e => { dragging = true; moveStick(e.touches[0]); });
  joystick.addEventListener('touchmove', e => { if(dragging) moveStick(e.touches[0]); });
  joystick.addEventListener('touchend', e => { dragging = false; stick.style.transform = `translate(-50%, -50%)`; stickX = 0; stickY = 0; });

  function moveStick(touch){
    const rect = joystick.getBoundingClientRect();
    let x = touch.clientX - rect.left - rect.width/2;
    let y = touch.clientY - rect.top - rect.height/2;
    const maxDist = rect.width/2 - stick.offsetWidth/2;
    const dist = Math.min(Math.hypot(x,y), maxDist);
    const angle = Math.atan2(y,x);
    stickX = Math.cos(angle) * dist / maxDist;
    stickY = Math.sin(angle) * dist / maxDist;
    stick.style.transform = `translate(${stickX*50 -50}%, ${stickY*50 -50}%)`;
  }

  // Клавіатура
  const keys = {};
  document.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
  document.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

  function animate(){
    requestAnimationFrame(animate);

    // Клавіші WASD
    if(keys['w']) velY = -1;
    else if(keys['s']) velY = 1;
    else velY = 0;

    if(keys['a']) velX = -1;
    else if(keys['d']) velX = 1;
    else velX = 0;

    // Джойстик
    velX += stickX;
    velY += stickY;

    posX += velX * speed;
    posY += velY * speed;

    // Обмеження по екрану
    posX = Math.max(25, Math.min(window.innerWidth-25, posX));
    posY = Math.max(25, Math.min(window.innerHeight-25, posY));

    cube.style.left = posX + 'px';
    cube.style.top = posY + 'px';
  }

  animate();
</script>

</body>
</html>
